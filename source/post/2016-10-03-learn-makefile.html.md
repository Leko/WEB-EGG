---
path: /post/learn-makefile/
title: Makefile初めて触った。めっちゃ簡単だった
date: 2016-10-03T11:30:22+00:00
dsq_thread_id:
  - "5191724074"
categories:
  - やってみた
tags:
  - CLI
---

こんにちは。れこです。  
`make`というコマンド自体は何らかをインストールするときとかにたまに触るのですが、  
自前で Makefile とやらを作ったことは今まで一度もなかった。

そんな私のはじめては「ISUCON 2016 の Go の参考実装で使われていたので、触らざるを得なかった」という出会いでした。笑

**「うわっ make コマンド叩くやつだ」** とわけの分からない気構えをしていたのですが、  
いざ触ってみたら学習コストほぼゼロで見やすくて使いやすいというとてもいいツールだったので簡単に紹介と備忘録を。

<!--more-->

## はじめに

Makefile が手に馴染んだのは、おそらく他のタスクランナーに触れたことがあるからな気がしています。  
例えば[Grunt](http://gruntjs.com/)や[gulp](http://gulpjs.com/)はよく使ってます。

で結論として、gulp のようにストリームをベースにした（js にロックインした）作りが必要でない限り、Makefile でいいんじゃなかろうかと感じました

make には色々な種類があるらしいので、ここでは参考記事に則って GNU make に関して記述します。

> [Makefile の書き方 (C 言語) &mdash; WTOPIA v1.0 documentation](http://www.ie.u-ryukyu.ac.jp/~e085739/c.makefile.tuts.html)

## Makefile を作ってみる

今回は Go のビルドをしたいのでおそらくこんな感じになるのかと。

```
build: main.go
    go get -u github.com/kataras/iris/iris
    go build -v -o app main.go
```

```
任意のタスク名: 対象のファイル名
    先頭をタブでインデントし、実行するコマンドを改行区切りで記述

任意のタスク名2:
    対象ファイルがなくてもいいらしい？
```

というとても簡素な書き方。

## make コマンドを叩いてみる

上記の Makefile だったら`make`もしくは`make build`で実行できます。  
make はタスク名を渡さなかった場合、ファイルないで最も先頭のタスクがデフォルトとして実行されるようです。

> デフォルトでは、Make は一番目のターゲットから開始します。このターゲットのことをデフォルトゴールと呼びます。
>
> &mdash; [Make について知っておくべき 7 つのこと \| インフラ・ミドルウェア | POSTD](http://postd.cc/7-things-you-should-know-about-make/)

## まとめ

**多機能すぎて現状いまいち掴みきれない**  
冒頭で学習コストゼロとか言ったのだれですか。最低限ならすぐ触れるけど奥が深すぎますよ。  
調べれば調べるほど色んな機能が出てきて理解が追いつくのはいつの話になるのやら、という感じでした…

それでも軽く触りの部分だけ触っただけで、温故知新とはこのことかと感じました。  
大袈裟すぎず、ちょうど手に収まるツールと言う感じがしました。  
まだ make 歴 2 日くらいなので、これからつらみやしぶみ、うまみを知って行きたいと思います。

---

本件とは全く関係ない蛇足。  
Makefile というファイル名を見ていてふと気になったのですが、  
今回の`Makefile`、Docker の`Dockerfile`、vagrant の`Vagrantfile`、Heroku の`Procfile`などの`{大文字から始まるツール名}file`というファイル名と、  
`.bowerrc`や`.babelrc`、`.editorconfig`などのドットから始まるファイル、なんかの派閥があるんでしょうか？

傍から見てると うまみうまあじ戦争 みたいだなーなんて思ってます。  
うまみ派は gulp でも使ってればいいと思います
