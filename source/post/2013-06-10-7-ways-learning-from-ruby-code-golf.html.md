---
path: /post/7-ways-learning-from-ruby-code-golf/
title: Rubyでコードゴルフする過程で知った7つの書き方
date: 2013-06-10T12:15:44+00:00
twitter_id:
  - "343931906276073475"
image: /images/2013/06/201306101.jpg
categories:
  - 効率化
tags:
  - Ruby
---

久々に、[CodeIQ のコードゴルフ](https://codeiq.jp/ace/ozy4dm/q335)をやりました。

数カ月ぶりに素の Ruby を触ったので色々と忘れていました。  
しかも Ruby でコードゴルフは初めてだったので、  
Google 先生に聞きながら書いているうちに知った、7 つのことをメモします。

<!--more-->

## 注意

小ネタが多めです。  
Ruby 初心者なので、Rubyist にとっては当たり前のことを知りません。 Rubyist の方なら知ってる内容が多かも知れませんが、ご容赦下さい。

なお、手元の Ruby のバージョンは、1.9.2 です。

## 多重代入

1 行ずつ代入するのと文字列長は変わらないけどやってみた。  
今回は使わなかったけど tmp を使わない swap にも使えるそう。

a,b..と順番に宣言していけば、a の値が必要な b の初期化も出来るかと思いましたが、  
それはエラーになりました。少し不便。

```rb
a, b = 1, 2 #=> a = 1, b = 2
a, b = 1, a + 2 #=> エラー
```

## 配列の宣言

`[]`を抜かしても、左辺の変数が 1 つなら、配列として入るようです。

```rb
a = 0, 1, 2, 3 #=> [0, 1, 2, 3]
```

これを応用して、右辺側に代入を混ぜてみました。

```rb
M = -1, v = y = 0, 1, 0 #=> M = [-1, 0, 1, 0], v = 0, y = 0
```

## ２次元配列の初期化

縦のサイズが決まっている場合に有効そうです。  
これはコードゴルフじゃなくても使えそうなイディオムです。

横のサイズも決まっていて、  
内側の配列も初期化したいなら、内側の Array.new のあとに map を続けて書けば行けます。

```rb
a = Array.new(2).map{Array.new} #=> [[],[]]
```

## 文字列のフォーマット指定(幅)

文字列の`%`メソッドを使います。  
C 言語の sprintf()とかとほぼ同様のフォーマットが使えます。  
扱えるフォーマットについては、<span class="removed_link" title="http://doc.ruby-lang.org/ja/1.9.2/class/String.html">こちら</span>を参照。

その書式で出力するわけではなく、**その書式の文字列が返る**ことに注意です。

```rb
a = "%3d" % 1 #=> " 1"(手前に足りない幅分のスペースが入る)
```

## 数値の桁数を取得する

文字列化して、長さを取得。

桁数取得に悩んでたら思いつきました。  
分かってみれば「知ってるよ」となりますが、盲点だった。

```rb
a = 1000.to_s.size #=> 4
```

## Range は降順にできない

Range は、`N…M`の書き方で N>M にすれば  
逆順になるのかと思ってましたが、ならないようです。

降順の連番をループで使いたいときは、  
Integer クラスに downto()というメソッドがあるそうです。

```rb
10.downto(1) {|i| #=> 10, 9, 8, ,7, 6, 5, 4, 3, 2, 1と順にアクセスできる }
```

## 配列の join()

なんだこの奇妙な挙動は…  
配列の`*`メソッドに文字列を渡すと、join と同じ結果になるようです。

```rb
a = [1, 2, 3, 4] a.join("|") #=> "1|2|3|4" a*"|" #=> "1|2|3|4"
```
